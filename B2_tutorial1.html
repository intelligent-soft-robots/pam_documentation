<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tutorial 1: Commands &mdash; PAM Documentation 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=8d563738"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Tutorial 2: Reading robot data" href="B3_tutorial2.html" />
    <link rel="prev" title="Tutorial 0: How to run tutorial demos" href="B1_tutorial0.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            PAM Documentation
          </a>
              <div class="version">
                1.0.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="A1_overview_and_installation.html">Overview and software installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="B1_tutorial0.html">Tutorial 0: How to run tutorial demos</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tutorial 1: Commands</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#starting-a-mujoco-simulated-robot">Starting a MuJoCo simulated robot</a></li>
<li class="toctree-l2"><a class="reference internal" href="#introduction-to-commands">Introduction to commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="#add-command-overloads">add_command overloads</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#controlling-only-selected-muscle-s">Controlling only selected muscle(s)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#controlling-a-degree-of-freedom">Controlling a degree of freedom</a></li>
<li class="toctree-l3"><a class="reference internal" href="#controlling-all-muscles">Controlling all muscles</a></li>
<li class="toctree-l3"><a class="reference internal" href="#speed-commands">Speed commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="#direct-commands">Direct commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="#iteration-command">Iteration command</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#introduction-to-handles">Introduction to handles</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="B3_tutorial2.html">Tutorial 2: Reading robot data</a></li>
<li class="toctree-l1"><a class="reference internal" href="B4_tutorial3.html">Tutorial 3: Iteration commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="B5_tutorial4.html">Tutorial 4: Joint control, table, balls, etc.</a></li>
<li class="toctree-l1"><a class="reference internal" href="B6_tutorial5.html">Tutorial 5: Saving data to files</a></li>
<li class="toctree-l1"><a class="reference internal" href="B7_tutorial6.html">Tutorial 6: Bursting mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="B8_tutorial7.html">Tutorial 7: Converting observations to other formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="C1_handle.html">More info: MuJoCo handles and contacts</a></li>
<li class="toctree-l1"><a class="reference internal" href="C2_real_robot.html">More info: Using the real robot</a></li>
<li class="toctree-l1"><a class="reference internal" href="C3_executables.html">More info: List of executables</a></li>
<li class="toctree-l1"><a class="reference internal" href="C4_mirroring.html">More info: Mirroring real robot</a></li>
<li class="toctree-l1"><a class="reference internal" href="C5_visual_ball_tracking.html">More info: Visual ball tracking</a></li>
<li class="toctree-l1"><a class="reference internal" href="C7_ball_launcher.html">More info: Ball launcher</a></li>
<li class="toctree-l1"><a class="reference internal" href="C8_low_latency.html">More info: Low latency kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="C9_vicon.html">More info: Vicon</a></li>
<li class="toctree-l1"><a class="reference internal" href="C9.1_tennicam_vicon_transform.html">More info: Compute Transformation from Tennicam to World Frame</a></li>
<li class="toctree-l1"><a class="reference internal" href="C91_webcam.html">More info: Webcams</a></li>
<li class="toctree-l1"><a class="reference internal" href="C92_saving_states.html">More info: Saving states to file</a></li>
<li class="toctree-l1"><a class="reference internal" href="D1_datasets.html">Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="E1_tools.html">Developer’s guide 1: Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="E2_guidelines.html">Developer’s guide 2: Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="E3_packages_overview.html">Developer’s guide 3: Packages overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="E4_advanced_overview.html">Developer’s guide 4: Advanced overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="E5_documentation.html">Developer’s guide: Updating the documentation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PAM Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Tutorial 1: Commands</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/B2_tutorial1.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="tutorial-1-commands">
<h1>Tutorial 1: Commands<a class="headerlink" href="#tutorial-1-commands" title="Link to this heading"></a></h1>
<section id="starting-a-mujoco-simulated-robot">
<h2>Starting a MuJoCo simulated robot<a class="headerlink" href="#starting-a-mujoco-simulated-robot" title="Link to this heading"></a></h2>
<p>In a terminal, call:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pam_mujoco<span class="w"> </span>tutorials_1_to_3
</pre></div>
</div>
<p>this will start an instance of pam_mujoco in a new terminal.</p>
<p>This instance does not start a simulated robot yet, as it works for a client
process to configure it.</p>
</section>
<section id="introduction-to-commands">
<h2>Introduction to commands<a class="headerlink" href="#introduction-to-commands" title="Link to this heading"></a></h2>
<p>You may now run tutorial_1.py</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python3<span class="w"> </span>./tutorial_1.py
</pre></div>
</div>
<p>Here some comments regarding the source code similar of the one of Tutorial 1.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="c1"># configuring pam_mujoco and getting an interface to it.</span>
<span class="c1"># More on handle somewhere below.</span>
<span class="c1"># In this specific case, this will configure pam_mujoco</span>
<span class="c1"># to start a pressure controlled robot</span>
<span class="n">handle</span> <span class="o">=</span> <span class="n">get_handle</span><span class="p">()</span>

<span class="c1"># getting an o80 frontend to the pressured robot</span>
<span class="c1"># The frontend will allow to send pressures to the robot</span>
<span class="c1"># and/or read the robot&#39;s state</span>
<span class="n">frontend</span> <span class="o">=</span> <span class="n">handle</span><span class="o">.</span><span class="n">frontends</span><span class="p">[</span><span class="s2">&quot;robot&quot;</span><span class="p">]</span>

<span class="n">pressure</span> <span class="o">=</span> <span class="mi">20000</span>
<span class="n">duration</span> <span class="o">=</span> <span class="mi">5</span> <span class="c1"># seconds</span>
<span class="c1"># creating a command locally. The command is *not* sent to the robot yet.</span>
<span class="n">frontend</span><span class="o">.</span><span class="n">add_command</span><span class="p">([</span><span class="n">pressure</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">,[</span><span class="n">pressure</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span>
                     <span class="n">o80</span><span class="o">.</span><span class="n">Duration_us</span><span class="o">.</span><span class="n">seconds</span><span class="p">(</span><span class="n">duration</span><span class="p">),</span>
                     <span class="n">o80</span><span class="o">.</span><span class="n">Mode</span><span class="o">.</span><span class="n">QUEUE</span><span class="p">)</span>

<span class="c1"># sending the command to the robot, and waiting for its completion.</span>
<span class="n">frontend</span><span class="o">.</span><span class="n">pulse_and_wait</span><span class="p">()</span>
</pre></div>
</div>
<p>You should observe the pressures of all muscles raising to 20000 in 5 seconds.</p>
<p>Note that you can add more than one command at once:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># adding a first command </span>
<span class="n">pressure</span> <span class="o">=</span> <span class="mi">12000</span>
<span class="n">duration</span> <span class="o">=</span> <span class="mi">3</span> <span class="c1"># seconds</span>
<span class="n">frontend</span><span class="o">.</span><span class="n">add_command</span><span class="p">([</span><span class="n">pressure</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">,[</span><span class="n">pressure</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span>
                     <span class="n">o80</span><span class="o">.</span><span class="n">Duration_us</span><span class="o">.</span><span class="n">seconds</span><span class="p">(</span><span class="n">duration</span><span class="p">),</span>
                     <span class="n">o80</span><span class="o">.</span><span class="n">Mode</span><span class="o">.</span><span class="n">QUEUE</span><span class="p">)</span>

<span class="c1"># adding a second command</span>
<span class="n">pressure</span> <span class="o">=</span> <span class="mi">20000</span>
<span class="n">frontend</span><span class="o">.</span><span class="n">add_command</span><span class="p">([</span><span class="n">pressure</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">,[</span><span class="n">pressure</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span>
                     <span class="n">o80</span><span class="o">.</span><span class="n">Duration_us</span><span class="o">.</span><span class="n">seconds</span><span class="p">(</span><span class="n">duration</span><span class="p">),</span>
                     <span class="n">o80</span><span class="o">.</span><span class="n">Mode</span><span class="o">.</span><span class="n">QUEUE</span><span class="p">)</span>


<span class="c1"># sending both commands to the robot, and waiting for their completions.</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;sending commands to shared memory and waiting for completion ...&quot;</span><span class="p">)</span>
<span class="n">frontend</span><span class="o">.</span><span class="n">pulse_and_wait</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;... completed !&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>In the program above, the method “pulse_and_wait” returns once both commands have been executed by the robot.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pressure</span> <span class="o">=</span> <span class="mi">15000</span>
<span class="n">duration</span><span class="o">=</span><span class="mi">10</span>
<span class="n">frontend</span><span class="o">.</span><span class="n">add_command</span><span class="p">([</span><span class="n">pressure</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">,[</span><span class="n">pressure</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span>
                     <span class="n">o80</span><span class="o">.</span><span class="n">Duration_us</span><span class="o">.</span><span class="n">seconds</span><span class="p">(</span><span class="n">duration</span><span class="p">),</span>
                     <span class="n">o80</span><span class="o">.</span><span class="n">Mode</span><span class="o">.</span><span class="n">QUEUE</span><span class="p">)</span>
<span class="n">pressure</span> <span class="o">=</span> <span class="mi">20000</span>
<span class="n">frontend</span><span class="o">.</span><span class="n">add_command</span><span class="p">([</span><span class="n">pressure</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">,[</span><span class="n">pressure</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span>
                     <span class="n">o80</span><span class="o">.</span><span class="n">Duration_us</span><span class="o">.</span><span class="n">seconds</span><span class="p">(</span><span class="n">duration</span><span class="p">),</span>
                     <span class="n">o80</span><span class="o">.</span><span class="n">Mode</span><span class="o">.</span><span class="n">QUEUE</span><span class="p">)</span>
<span class="c1"># sending command to the robot, and returning immediately</span>
<span class="n">frontend</span><span class="o">.</span><span class="n">pulse</span><span class="p">()</span>
</pre></div>
</div>
<p>Above, we use the method “pulse” instead of “pulse_and_wait”. You may notice that the method returns immediately. “pulse” writes the command in the shared memory, and the robot executes it. But as the robot does this, you may create new commands.</p>
<p>For example, rerun the code above, and immediately execute:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pressure</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">duration</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">frontend</span><span class="o">.</span><span class="n">add_command</span><span class="p">([</span><span class="n">pressure</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">,[</span><span class="n">pressure</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span>
                     <span class="n">o80</span><span class="o">.</span><span class="n">Duration_us</span><span class="o">.</span><span class="n">seconds</span><span class="p">(</span><span class="n">duration</span><span class="p">),</span>
                     <span class="n">o80</span><span class="o">.</span><span class="n">Mode</span><span class="o">.</span><span class="n">QUEUE</span><span class="p">)</span>
<span class="n">frontend</span><span class="o">.</span><span class="n">pulse</span><span class="p">()</span>
</pre></div>
</div>
<p>You may notice that the pressures of the muscles go to 15000, then 20000, and finally to 0 (or their minimal pressure value). While the robot was running the commands for setting the pressures to 15000 and 20000, it receives the supplementary command to set the pressures to 0. The mode <em>o80.Mode.QUEUE</em> commanded the command to go to pressure 0 to start only once the other commands have been achieved. On the contrary, if we had run:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pressure</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">duration</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">frontend</span><span class="o">.</span><span class="n">add_command</span><span class="p">([</span><span class="n">pressure</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">,[</span><span class="n">pressure</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span>
                     <span class="n">o80</span><span class="o">.</span><span class="n">Duration_us</span><span class="o">.</span><span class="n">seconds</span><span class="p">(</span><span class="n">duration</span><span class="p">),</span>
                     <span class="n">o80</span><span class="o">.</span><span class="n">Mode</span><span class="o">.</span><span class="n">OVERWRITE</span><span class="p">)</span>
<span class="n">frontend</span><span class="o">.</span><span class="n">pulse</span><span class="p">()</span>
</pre></div>
</div>
<p>the mode <em>o80.Mode.OVERWRITE</em> has the command to go to pressure 0 replacing the previous command. Similarly:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pressure</span> <span class="o">=</span> <span class="mi">12000</span>
<span class="n">duration</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">frontend</span><span class="o">.</span><span class="n">add_command</span><span class="p">([</span><span class="n">pressure</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">,[</span><span class="n">pressure</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span>
                     <span class="n">o80</span><span class="o">.</span><span class="n">Duration_us</span><span class="o">.</span><span class="n">seconds</span><span class="p">(</span><span class="n">duration</span><span class="p">),</span>
                     <span class="n">o80</span><span class="o">.</span><span class="n">Mode</span><span class="o">.</span><span class="n">QUEUE</span><span class="p">)</span>
<span class="n">frontend</span><span class="o">.</span><span class="n">pulse</span><span class="p">()</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">pressure</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">duration</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">frontend</span><span class="o">.</span><span class="n">add_command</span><span class="p">([</span><span class="n">pressure</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">,[</span><span class="n">pressure</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span>
                     <span class="n">o80</span><span class="o">.</span><span class="n">Duration_us</span><span class="o">.</span><span class="n">seconds</span><span class="p">(</span><span class="n">duration</span><span class="p">),</span>
                     <span class="n">o80</span><span class="o">.</span><span class="n">Mode</span><span class="o">.</span><span class="n">OVERWRITE</span><span class="p">)</span>
<span class="n">frontend</span><span class="o">.</span><span class="n">pulse</span><span class="p">()</span>
</pre></div>
</div>
<p>the code above has the robot starting to go toward the pressures 12000, but after 5 seconds this is interrupted (<em>o80.Mode.OVERWRITE</em> used) and the pressures brutally (in 1 second) go to 0.</p>
</section>
<section id="add-command-overloads">
<h2>add_command overloads<a class="headerlink" href="#add-command-overloads" title="Link to this heading"></a></h2>
<section id="controlling-only-selected-muscle-s">
<h3>Controlling only selected muscle(s)<a class="headerlink" href="#controlling-only-selected-muscle-s" title="Link to this heading"></a></h3>
<p>All the commands applied so far targeted all muscles. It is possible to request the change of the pressure of only one muscle:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">muscle</span><span class="o">=</span><span class="mi">0</span>
<span class="n">frontend</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">muscle</span><span class="p">,</span><span class="mi">12000</span><span class="p">,</span><span class="n">o80</span><span class="o">.</span><span class="n">Duration_us</span><span class="o">.</span><span class="n">seconds</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">o80</span><span class="o">.</span><span class="n">Mode</span><span class="o">.</span><span class="n">OVERWRITE</span><span class="p">)</span>
<span class="n">frontend</span><span class="o">.</span><span class="n">pulse</span><span class="p">()</span>
</pre></div>
</div>
<p>The above will request a change in the pressure of the muscle indexed 0.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">frontend</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">15000</span><span class="p">,</span><span class="n">o80</span><span class="o">.</span><span class="n">Duration_us</span><span class="o">.</span><span class="n">seconds</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">o80</span><span class="o">.</span><span class="n">Mode</span><span class="o">.</span><span class="n">OVERWRITE</span><span class="p">)</span>
<span class="n">frontend</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">20000</span><span class="p">,</span><span class="n">o80</span><span class="o">.</span><span class="n">Duration_us</span><span class="o">.</span><span class="n">seconds</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">o80</span><span class="o">.</span><span class="n">Mode</span><span class="o">.</span><span class="n">OVERWRITE</span><span class="p">)</span>
<span class="n">frontend</span><span class="o">.</span><span class="n">pulse</span><span class="p">()</span>
</pre></div>
</div>
<p>Note that the command above will have the muscles 0 and 1 changing pressure at the same time. Because these two commands target 2 different muscles, the second command does not overwrite the first one.</p>
</section>
<section id="controlling-a-degree-of-freedom">
<h3>Controlling a degree of freedom<a class="headerlink" href="#controlling-a-degree-of-freedom" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dof</span><span class="o">=</span><span class="mi">0</span>
<span class="n">frontend</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">dof</span><span class="p">,</span><span class="mi">20000</span><span class="p">,</span><span class="mi">15000</span><span class="p">,</span><span class="n">o80</span><span class="o">.</span><span class="n">Duration_us</span><span class="o">.</span><span class="n">seconds</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">o80</span><span class="o">.</span><span class="n">Mode</span><span class="o">.</span><span class="n">OVERWRITE</span><span class="p">)</span>
<span class="n">frontend</span><span class="o">.</span><span class="n">pulse</span><span class="p">()</span>
</pre></div>
</div>
<p>The command above will have the pressures of the agonist and antagonist muscles of the degree of freedom indexed 0 reach the values 20000 and 15000 (respectively) in 3 seconds.</p>
</section>
<section id="controlling-all-muscles">
<h3>Controlling all muscles<a class="headerlink" href="#controlling-all-muscles" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">agonists</span> <span class="o">=</span> <span class="p">[</span><span class="mi">15000</span><span class="p">,</span><span class="mi">16000</span><span class="p">,</span><span class="mi">17000</span><span class="p">,</span><span class="mi">18000</span><span class="p">]</span>
<span class="n">antagonists</span> <span class="o">=</span> <span class="p">[</span><span class="mi">18000</span><span class="p">,</span><span class="mi">17000</span><span class="p">,</span><span class="mi">16000</span><span class="p">,</span><span class="mi">15000</span><span class="p">]</span>
<span class="n">frontend</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">agonists</span><span class="p">,</span><span class="n">antagonists</span><span class="p">,</span><span class="n">o80</span><span class="o">.</span><span class="n">Duration_us</span><span class="o">.</span><span class="n">seconds</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">o80</span><span class="o">.</span><span class="n">Mode</span><span class="o">.</span><span class="n">OVERWRITE</span><span class="p">)</span>
<span class="n">frontend</span><span class="o">.</span><span class="n">pulse</span><span class="p">()</span>
</pre></div>
</div>
<p>This command will target all muscles, for example the target pressure values for the first degree of freedom will be (15000,18000).</p>
</section>
<section id="speed-commands">
<h3>Speed commands<a class="headerlink" href="#speed-commands" title="Link to this heading"></a></h3>
<p>All the commands so far have been <em>duration</em> command, i.e. the request to interpolate between the current desired pressure value to a target desired pressure value over a given duration. It is possible to also create speed command, i.e. requesting the desired pressures to achieve a target value at a certain velocity (in terms of unit of pressure per unit of time).</p>
<p>Here are examples of speed commands:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">agonists</span> <span class="o">=</span> <span class="p">[</span><span class="mi">15000</span><span class="p">,</span><span class="mi">16000</span><span class="p">,</span><span class="mi">17000</span><span class="p">,</span><span class="mi">18000</span><span class="p">]</span>
<span class="n">antagonists</span> <span class="o">=</span> <span class="p">[</span><span class="mi">18000</span><span class="p">,</span><span class="mi">17000</span><span class="p">,</span><span class="mi">16000</span><span class="p">,</span><span class="mi">15000</span><span class="p">]</span>
<span class="n">frontend</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">dof</span><span class="p">,</span><span class="mi">20000</span><span class="p">,</span><span class="mi">15000</span><span class="p">,</span><span class="n">o80</span><span class="o">.</span><span class="n">Speed</span><span class="o">.</span><span class="n">per_second</span><span class="p">(</span><span class="mi">300</span><span class="p">),</span><span class="n">o80</span><span class="o">.</span><span class="n">Mode</span><span class="o">.</span><span class="n">OVERWRITE</span><span class="p">)</span>
<span class="n">dof</span><span class="o">=</span><span class="mi">0</span>
<span class="n">frontend</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">dof</span><span class="p">,</span><span class="mi">20000</span><span class="p">,</span><span class="mi">15000</span><span class="p">,</span><span class="n">o80</span><span class="o">.</span><span class="n">Speed</span><span class="o">.</span><span class="n">per_second</span><span class="p">(</span><span class="mi">200</span><span class="p">),</span><span class="n">o80</span><span class="o">.</span><span class="n">Mode</span><span class="o">.</span><span class="n">QUEUE</span><span class="p">)</span>
<span class="n">frontend</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">15000</span><span class="p">,</span><span class="n">o80</span><span class="o">.</span><span class="n">Speed</span><span class="o">.</span><span class="n">per_second</span><span class="p">(</span><span class="mi">400</span><span class="p">),</span><span class="n">o80</span><span class="o">.</span><span class="n">Mode</span><span class="o">.</span><span class="n">OVERWRITE</span><span class="p">)</span>
<span class="n">frontend</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">20000</span><span class="p">,</span><span class="n">o80</span><span class="o">.</span><span class="n">Speed</span><span class="o">.</span><span class="n">per_second</span><span class="p">(</span><span class="mi">300</span><span class="p">),</span><span class="n">o80</span><span class="o">.</span><span class="n">Mode</span><span class="o">.</span><span class="n">OVERWRITE</span><span class="p">)</span>
<span class="n">frontend</span><span class="o">.</span><span class="n">pulse</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="direct-commands">
<h3>Direct commands<a class="headerlink" href="#direct-commands" title="Link to this heading"></a></h3>
<p>It is possible to create commands that do not specify any duration or speed. Direct commands request the desired pressure to reach the target pressure as fast as possible. For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># creating a sinusoid trajectory</span>
<span class="n">pressure</span> <span class="o">=</span> <span class="mi">15000</span>                                                                                                                                                                                            
<span class="n">v</span> <span class="o">=</span> <span class="mf">0.</span>                                                                                                                                                                                                      
<span class="n">increment</span> <span class="o">=</span> <span class="mf">0.025</span>                                                                                                                                                                                           
<span class="n">amplitude</span> <span class="o">=</span> <span class="mi">3000</span> 
<span class="n">dof</span><span class="o">=</span><span class="mi">2</span>                                                                                                                                                                                           
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5000</span><span class="p">):</span>                                                                                                                                                                                        
    <span class="n">v</span><span class="o">+=</span><span class="n">increment</span>                                                                                                                                                                                            
    <span class="n">ago</span> <span class="o">=</span> <span class="n">pressure</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">amplitude</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>                                                                                                                                                             
    <span class="n">antago</span> <span class="o">=</span> <span class="n">pressure</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">amplitude</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>                                                                                                                                                          
    <span class="n">frontend</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">dof</span><span class="p">,</span>                                                                                                                                                                           
                         <span class="n">ago</span><span class="p">,</span><span class="n">antago</span><span class="p">,</span>                                                                                                                                                                    
                         <span class="n">o80</span><span class="o">.</span><span class="n">Mode</span><span class="o">.</span><span class="n">QUEUE</span><span class="p">)</span>                                                                                                                                                                
<span class="c1"># playing the trajectory                                                                                                                                                                               </span>
<span class="n">frontend</span><span class="o">.</span><span class="n">pulse_and_wait</span><span class="p">()</span>                                                                                                                                                                                   
</pre></div>
</div>
<p>Similarly to duration and speed commands, direct commands may use o80.Mode.QUEUE or o80.Mode.OVERWRITE, and refers to specific muscles, degrees of freedom or full set of pressures</p>
</section>
<section id="iteration-command">
<h3>Iteration command<a class="headerlink" href="#iteration-command" title="Link to this heading"></a></h3>
<p>Iteration command are an advanced type of command covered later in this tutorial.</p>
</section>
</section>
<section id="introduction-to-handles">
<h2>Introduction to handles<a class="headerlink" href="#introduction-to-handles" title="Link to this heading"></a></h2>
<p>The tutorial above started with:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">handle</span> <span class="o">=</span> <span class="n">get_handle</span><span class="p">()</span>
</pre></div>
</div>
<p>The code for the <em>get_handle</em> function is similar to:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_handle</span><span class="p">():</span>
    <span class="n">mujoco_id</span> <span class="o">=</span> <span class="s2">&quot;tutorials_1_to_3&quot;</span>
    <span class="n">robot_segment_id</span> <span class="o">=</span> <span class="s2">&quot;robot&quot;</span>
    <span class="n">control</span> <span class="o">=</span> <span class="n">pam_mujoco</span><span class="o">.</span><span class="n">MujocoRobot</span><span class="o">.</span><span class="n">PRESSURE_CONTROL</span>
    <span class="n">robot</span> <span class="o">=</span> <span class="n">pam_mujoco</span><span class="o">.</span><span class="n">MujocoRobot</span><span class="p">(</span><span class="n">robot_segment_id</span><span class="p">,</span>
                                   <span class="n">control</span><span class="o">=</span><span class="n">control</span><span class="p">)</span>
    <span class="n">graphics</span><span class="o">=</span><span class="kc">True</span>
    <span class="n">accelerated_time</span><span class="o">=</span><span class="kc">False</span>
    <span class="n">handle</span> <span class="o">=</span> <span class="n">pam_mujoco</span><span class="o">.</span><span class="n">MujocoHandle</span><span class="p">(</span><span class="n">mujoco_id</span><span class="p">,</span>
                                     <span class="n">robot1</span><span class="o">=</span><span class="n">robot</span><span class="p">,</span>
                                     <span class="n">graphics</span><span class="o">=</span><span class="n">graphics</span><span class="p">,</span>
                                     <span class="n">accelerated_time</span><span class="o">=</span><span class="n">accelerated_time</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">handle</span>
</pre></div>
</div>
<p>The code above requested to create an handle to the <em>pam_mujoco</em> process running on the mujoco_id
“tutorials_1_3”, and configuring it:</p>
<ul class="simple">
<li><p>to run a pressure controlled robot with segment_id “robot”</p></li>
<li><p>to show MuJoCo graphics</p></li>
<li><p>to run realtime (and not accelerated_time)</p></li>
</ul>
<p>During the handle creation, the corresponding configuration is written in the shared memory, and
the waiting <em>pam_mujoco</em> instance uses it to start.</p>
<p>The handle provides access to the corresponding o80 robot frontend, which will allow to send
commands to the robot:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">frontend</span> <span class="o">=</span> <span class="n">handle</span><span class="o">.</span><span class="n">frontends</span><span class="p">[</span><span class="s2">&quot;robot&quot;</span><span class="p">]</span>
<span class="c1"># &quot;robot&quot; is the robot_segment_id as set in the handle</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="B1_tutorial0.html" class="btn btn-neutral float-left" title="Tutorial 0: How to run tutorial demos" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="B3_tutorial2.html" class="btn btn-neutral float-right" title="Tutorial 2: Reading robot data" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Empirical Inference, Max Planck Institute for Intelligent Systems.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
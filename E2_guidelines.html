<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Developer’s guide 2: Guidelines &mdash; PAM Documentation 1.0.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Developer’s guide 3: Packages overview" href="E3_packages_overview.html" />
    <link rel="prev" title="Developer’s guide 1: Tools" href="E1_tools.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> PAM Documentation
          </a>
              <div class="version">
                1.0.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="A1_overview_and_installation.html">Overview and software installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="B1_tutorial0.html">Tutorial 0: How to run tutorial demos</a></li>
<li class="toctree-l1"><a class="reference internal" href="B2_tutorial1.html">Tutorial 1: Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="B3_tutorial2.html">Tutorial 2: Reading robot data</a></li>
<li class="toctree-l1"><a class="reference internal" href="B4_tutorial3.html">Tutorial 3: Iteration commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="B5_tutorial4.html">Tutorial 4: Joint control, table, balls, etc.</a></li>
<li class="toctree-l1"><a class="reference internal" href="B6_tutorial5.html">Tutorial 5: Saving data to files</a></li>
<li class="toctree-l1"><a class="reference internal" href="B7_tutorial6.html">Tutorial 6: Bursting mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="C1_handle.html">More info: MuJoCo handles and contacts</a></li>
<li class="toctree-l1"><a class="reference internal" href="C2_real_robot.html">More info: Using the real robot</a></li>
<li class="toctree-l1"><a class="reference internal" href="C3_executables.html">More info: List of executables</a></li>
<li class="toctree-l1"><a class="reference internal" href="C4_mirroring.html">More info: Mirroring real robot</a></li>
<li class="toctree-l1"><a class="reference internal" href="C5_visual_ball_tracking.html">More info: Visual ball tracking</a></li>
<li class="toctree-l1"><a class="reference internal" href="C7_ball_launcher.html">More info: Ball launcher</a></li>
<li class="toctree-l1"><a class="reference internal" href="C8_low_latency.html">More info: Low latency kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="C9_vicon.html">More info: Vicon</a></li>
<li class="toctree-l1"><a class="reference internal" href="C9.1_tennicam_vicon_transform.html">More info: Compute Transformation from Tennicam to World Frame</a></li>
<li class="toctree-l1"><a class="reference internal" href="E1_tools.html">Developer’s guide 1: Tools</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Developer’s guide 2: Guidelines</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#working-on-a-git-branch">Working on a git branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="#code-update">Code Update</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#unit-tests">Unit Tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="#demos">Demos</a></li>
<li class="toctree-l3"><a class="reference internal" href="#documentation">Documentation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#code-documentation">Code documentation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#package-documentation">Package documentation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#build-the-documentation">Build the documentation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#code-style-guide">Code style guide</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#formatting">Formatting</a></li>
<li class="toctree-l4"><a class="reference internal" href="#naming-conventions">Naming conventions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#python-specific-guidelines">Python specific guidelines</a></li>
<li class="toctree-l4"><a class="reference internal" href="#c-specific-guidelines">C++ specific guidelines</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#merging-to-master-main-branch">Merging to master/main branch</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#before-opening-a-pull-request">Before opening a pull request</a></li>
<li class="toctree-l3"><a class="reference internal" href="#creating-a-pull-request">Creating a pull request</a></li>
<li class="toctree-l3"><a class="reference internal" href="#during-the-review">During the review</a></li>
<li class="toctree-l3"><a class="reference internal" href="#merging-a-pull-request">Merging a pull request</a></li>
<li class="toctree-l3"><a class="reference internal" href="#some-general-rules-for-pull-requests">Some general rules for pull requests:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#on-which-packages-is-code-review-required">On which packages is code review required?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#being-a-reviewer">Being a Reviewer</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="E3_packages_overview.html">Developer’s guide 3: Packages overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="E4_advanced_overview.html">Developer’s guide 4: Advanced overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="E5_documentation.html">Developer’s guide: Updating the documentation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PAM Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Developer’s guide 2: Guidelines</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/E2_guidelines.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="developer-s-guide-2-guidelines">
<h1>Developer’s guide 2: Guidelines<a class="headerlink" href="#developer-s-guide-2-guidelines" title="Permalink to this headline"></a></h1>
<blockquote>
<div><p>Always code as if the guy who ends up maintaining your code will be a violent
psychopath who knows where you live.  <em>— John Woods</em></p>
</div></blockquote>
<p>This section describes the rules to follow to get new code integrated in any of the repository.</p>
<section id="working-on-a-git-branch">
<h2>Working on a git branch<a class="headerlink" href="#working-on-a-git-branch" title="Permalink to this headline"></a></h2>
<p>Before starting to work on a repository, create a branch: <code class="docutils literal notranslate"><span class="pre">your_name/what_you_will_work_on</span></code>.</p>
<p>For example: <code class="docutils literal notranslate"><span class="pre">vberenz/adding_eigen_support</span></code></p>
<p>Work on this branch and push as many commits as you wish.</p>
</section>
<section id="code-update">
<h2>Code Update<a class="headerlink" href="#code-update" title="Permalink to this headline"></a></h2>
<p>When you update code, you must consider:</p>
<section id="unit-tests">
<h3>Unit Tests<a class="headerlink" href="#unit-tests" title="Permalink to this headline"></a></h3>
<p>Update existing unit tests or create new ones. Here are <a class="reference external" href="https://github.com/intelligent-soft-robots/context/blob/master/tests/unit_tests.cpp">examples</a> of unit tests.</p>
</section>
<section id="demos">
<h3>Demos<a class="headerlink" href="#demos" title="Permalink to this headline"></a></h3>
<p>A demo is an executable that provides a usage example of the code. Demos should be a simple as short as possible. Demos are very useful for users to understand rapidly how the code work.</p>
<p>Typically, demos are hosted in packages (as for example <a class="reference external" href="https://github.com/intelligent-soft-robots/pam_mujoco/tree/master/demos">here</a>).
When a demo requires code from various repositories, they can be hosted in a dedicated repository, as for example <a class="reference external" href="https://github.com/intelligent-soft-robots/pam_demos">pam_demos</a>.</p>
</section>
<section id="documentation">
<h3>Documentation<a class="headerlink" href="#documentation" title="Permalink to this headline"></a></h3>
<section id="code-documentation">
<h4>Code documentation<a class="headerlink" href="#code-documentation" title="Permalink to this headline"></a></h4>
<p>All code shall be documented in-source.  This means that every function, class,
struct, global variable, etc., needs to have a docstring/comment containing some
documentation in:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://sphinxcontrib-napoleon.readthedocs.io/en/latest/example_google.html">Google style</a>
for Python,</p></li>
<li><p><a class="reference external" href="http://www.doxygen.nl/manual/index.html">Doxygen</a> format for C++.</p></li>
</ul>
<p>If the definition and declaration are separated (C++), Doxygen should be in
the header, not the cpp file. <strong>Please do not duplicate!</strong>.</p>
<p>Make the documentation as compact as possible. Avoid boilerplate formulations
that do not add useful information, e.g. instead of
“This function returns foobar” simply write “Returns foobar”.</p>
<p>Also add regular comments to the code whenever you feel that they would help a
future reader to more easily understand what that code is doing.</p>
<p>See <a class="reference external" href="https://github.com/intelligent-soft-robots/o80/blob/master/include/o80/back_end.hpp">this file</a>
for an example in C++.  Our code base currently does not have enough
documentation, please help us doing better!</p>
</section>
<section id="package-documentation">
<h4>Package documentation<a class="headerlink" href="#package-documentation" title="Permalink to this headline"></a></h4>
<p>More general documentation of a package (e.g. describing how to run the software
on the robot) can be written in separate reStructuredText-files that are stored
in a folder <code class="docutils literal notranslate"><span class="pre">doc/</span></code> inside the package.</p>
</section>
<section id="build-the-documentation">
<h4>Build the documentation<a class="headerlink" href="#build-the-documentation" title="Permalink to this headline"></a></h4>
<p>If you are using CMake, the package may include the <code class="docutils literal notranslate"><span class="pre">mpi_cmake_modules</span></code> package
and in the CMakeLists.txt file call the <code class="docutils literal notranslate"><span class="pre">add_documentation()</span></code> macro.  The
documentation can then be build via</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>colcon build --cmake-args -DGENERATE_DOCUMENTATION=ON
</pre></div>
</div>
<p>Once built, the documentation can then be found in
<code class="docutils literal notranslate"><span class="pre">build/package_name/share/docs/sphinx/html</span></code>.</p>
</section>
</section>
<section id="code-style-guide">
<h3>Code style guide<a class="headerlink" href="#code-style-guide" title="Permalink to this headline"></a></h3>
<section id="formatting">
<h4>Formatting<a class="headerlink" href="#formatting" title="Permalink to this headline"></a></h4>
<p>We are using auto-formatting tools to format our code.  So while writing your
code, you don’t have to worry about things like indentation, spaces, brace
positions, etc.  Simply run the corresponding tool (depending on the language)
on the file before committing your changes.</p>
<p>For <strong>C++</strong>, use the executable <code class="docutils literal notranslate"><span class="pre">mpi_cpp_format</span></code> (which should already be
in your path if you followed the installation instruction):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mpi_cpp_format<span class="w"> </span>path/to/file_or_folder
</pre></div>
</div>
<p>If a folder is given, it searches for C++ files recursively.</p>
<p>For <strong>Python</strong>, use <a class="reference external" href="https://black.readthedocs.io">Black</a> (it can easily be
installed via <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">black</span></code>):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>black<span class="w"> </span>path/to/file_or_folder
</pre></div>
</div>
</section>
<section id="naming-conventions">
<h4>Naming conventions<a class="headerlink" href="#naming-conventions" title="Permalink to this headline"></a></h4>
<p>Give as descriptive a name as possible, within reason. Do not worry about saving
horizontal space as it is far more important to make your code immediately
understandable by a new reader. Do not use abbreviations that are ambiguous or
unfamiliar to readers outside your project, and do not abbreviate by deleting
letters within a word. Abbreviations that would be familiar to someone outside
your project with relevant domain knowledge are OK. As a rule of thumb, an
abbreviation is probably OK if it’s listed in Wikipedia.</p>
<p>Formatting of names should be as follows:</p>
<ul class="simple">
<li><p>Package names: <code class="docutils literal notranslate"><span class="pre">lower_case_with_underscores</span></code></p></li>
<li><p>Repositories should be named exactly the same as the package they contain.</p></li>
<li><p>Types (classes, structs, …): <code class="docutils literal notranslate"><span class="pre">FirstUpperCamelCase</span></code></p></li>
<li><p>Functions, methods: <code class="docutils literal notranslate"><span class="pre">lower_case_with_underscores</span></code></p></li>
<li><p>Variables: <code class="docutils literal notranslate"><span class="pre">lower_case_with_underscores</span></code></p>
<ul>
<li><p><strong>[C++ only]</strong> Class members: <code class="docutils literal notranslate"><span class="pre">like_variables_but_with_trailing_underscore_</span></code></p></li>
</ul>
</li>
<li><p>Constants: <code class="docutils literal notranslate"><span class="pre">UPPER_CASE_WITH_UNDERSCORES</span></code></p></li>
<li><p>Global variables: Should generally be avoided but if needed, prefix them with
g_, i.e. <code class="docutils literal notranslate"><span class="pre">g_variable_name</span></code>.</p></li>
</ul>
<section id="add-units-to-variable-names">
<h5>Add units to variable names<a class="headerlink" href="#add-units-to-variable-names" title="Permalink to this headline"></a></h5>
<p>Variables that hold values of a specific unit should have that unit appended to
the name.  For example if a variable holds the velocity of a motor in <em>krpm</em> it
should be called <code class="docutils literal notranslate"><span class="pre">velocity_krpm</span></code> instead of just <code class="docutils literal notranslate"><span class="pre">velocity</span></code>. Some more examples:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">voltage_mV</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">duration_us</span></code> (use “u” instead of “µ”)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">acceleration_mps2</span></code> (m/s^2)</p></li>
</ul>
</section>
</section>
<section id="python-specific-guidelines">
<h4>Python specific guidelines<a class="headerlink" href="#python-specific-guidelines" title="Permalink to this headline"></a></h4>
<ul>
<li><p>Follow <a class="reference external" href="https://www.python.org/dev/peps/pep-0008/">PEP 8</a>.</p>
<ul>
<li><p>Exception: For the line length we use Black’s default of 88 characters.  If
for a specific package you need to stick with 79 instead (e.g. due to
external requirements), add a file <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> with the following
content to the package:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[tool.black]
line-length = 79
</pre></div>
</div>
</li>
</ul>
</li>
<li><p>It is recommended to run a linter like <a class="reference external" href="https://flake8.pycqa.org">flake8</a> and
fix any warnings that it shows.  When used in combination with Black, you may
use the following configuration:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[flake8]
max-line-length=88
ignore=E203,W503
</pre></div>
</div>
</li>
</ul>
</section>
<section id="c-specific-guidelines">
<h4>C++ specific guidelines<a class="headerlink" href="#c-specific-guidelines" title="Permalink to this headline"></a></h4>
<section id="folder-tructure-and-file-naming">
<h5>Folder tructure and file naming<a class="headerlink" href="#folder-tructure-and-file-naming" title="Permalink to this headline"></a></h5>
<p>General folder structure of a package with C++ code:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;package_name&gt;
│
├── include
│   └── &lt;package_name&gt;   &lt;-- Header files go here
│       └── foo.hpp
├── src                  &lt;-- cpp-files go here
│   └── foo.cpp
...
</pre></div>
</div>
<ul class="simple">
<li><p>Header files have file extension <code class="docutils literal notranslate"><span class="pre">.hpp</span></code> and go to <code class="docutils literal notranslate"><span class="pre">include/&lt;package_name&gt;/</span></code>.</p></li>
<li><p>Source files have file extension <code class="docutils literal notranslate"><span class="pre">.cpp</span></code> and go to <code class="docutils literal notranslate"><span class="pre">src/</span></code>.</p></li>
<li><p>When using templates:  If you want to separate declaration and definition, put
the declaration to a <code class="docutils literal notranslate"><span class="pre">.hpp</span></code> header file as usual and the definition to a file
with extension <code class="docutils literal notranslate"><span class="pre">.hxx</span></code> in the same directory (which is included at the bottom
of the <code class="docutils literal notranslate"><span class="pre">.hpp</span></code> file).</p></li>
<li><p>Preferably each class should be in a separate file with name
<code class="docutils literal notranslate"><span class="pre">class_name_in_lower_case.*</span></code>.  However, this is not a strict rule, if several
smaller classes are logically closely related, they may go to the same file.</p></li>
<li><p>Executable scripts shall be placed in the <code class="docutils literal notranslate"><span class="pre">scripts/</span></code> folder. And should have
a CMake <strong>install rule</strong> that makes them executable upon installation.</p></li>
<li><p>The C++/pybind11 code for wrapping C++ code to Python shall be placed in
<code class="docutils literal notranslate"><span class="pre">srcpy/</span></code></p></li>
</ul>
</section>
<section id="always-add-braces">
<h5>Always add braces<a class="headerlink" href="#always-add-braces" title="Permalink to this headline"></a></h5>
<p><strong>Always</strong> add braces for single-line if/loop/etc.  They may seem unnecessary
but they highly reduce the risk of introducing bugs if the block is extended in
the future.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// good:</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">condition</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">foo</span><span class="p">();</span>
<span class="p">}</span>

<span class="c1">// bad:</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">condition</span><span class="p">)</span>
<span class="w">    </span><span class="n">foo</span><span class="p">();</span>
</pre></div>
</div>
</section>
<section id="pass-objects-by-const-reference">
<h5>Pass objects by const reference<a class="headerlink" href="#pass-objects-by-const-reference" title="Permalink to this headline"></a></h5>
<p>In general, non-primitive data types should be passed to functions by const
reference to avoid unnecessary copies.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">foobar</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Foo</span><span class="w"> </span><span class="o">&amp;</span><span class="n">foo</span><span class="p">);</span><span class="w">  </span><span class="c1">// good</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">foobar</span><span class="p">(</span><span class="n">Foo</span><span class="w"> </span><span class="n">foo</span><span class="p">);</span><span class="w">  </span><span class="c1">// results in copy of `foo`. Only do this if there is a</span>
<span class="w">                       </span><span class="c1">// specific need for it.</span>
</pre></div>
</div>
</section>
<section id="pragma-once-vs-include-guards">
<h5>pragma once vs include guards<a class="headerlink" href="#pragma-once-vs-include-guards" title="Permalink to this headline"></a></h5>
<p>Prefer <code class="docutils literal notranslate"><span class="pre">#pragma</span> <span class="pre">once</span></code> over include guards.  <code class="docutils literal notranslate"><span class="pre">#pragma</span> <span class="pre">once</span></code> is not part of the
official standard but is widely supported by compilers and much easier to
maintain.</p>
<p>Note that there are some border cases where <code class="docutils literal notranslate"><span class="pre">#pragma</span> <span class="pre">once</span></code> is causing issues
(e.g. on Windows or when having a weird build setup with symlinks or copies of
files). In such cases use traditional include guards. Make sure they have unique
names by composing them from the package name and the path/name of the file
(e.g. <code class="docutils literal notranslate"><span class="pre">MY_PACKAGE_PATH_TO_FILE_FILENAME_H</span></code>). Please <strong>do not</strong> add underscores
as prefix or suffix because this is reserved for the compiler pre-proccesor
variables.</p>
</section>
<section id="keep-scopes-small">
<h5>Keep scopes small<a class="headerlink" href="#keep-scopes-small" title="Permalink to this headline"></a></h5>
<p>Avoid adding anything to the global namespace if possible. This means</p>
<ul class="simple">
<li><p>Use a namespace when defining extern symbols.</p></li>
<li><p>Use an anonymous namespace or static for symbols that are only used internally.</p></li>
</ul>
<p>Generally define symbols in the smallest possible scope, i.e. if a variable is
only used inside one loop, define it inside this loop (however, do not consider
this to be a very strict rule, deviate from it where it seems reasonable).</p>
</section>
<section id="use-types-with-explicit-sizes">
<h5>Use types with explicit sizes<a class="headerlink" href="#use-types-with-explicit-sizes" title="Permalink to this headline"></a></h5>
<p>The header <em>stdint</em> defines primitive types with explicit sizes:
<em>int32_t</em>, <em>uint32_t</em>, <em>int16_t</em>, …
They should be preferred over the build-in types int, unsigned, short, …
To use them add the following include:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#include &lt;stdint&gt;
</pre></div>
</div>
</section>
</section>
</section>
</section>
<section id="merging-to-master-main-branch">
<h2>Merging to master/main branch<a class="headerlink" href="#merging-to-master-main-branch" title="Permalink to this headline"></a></h2>
<p>Once the code on the branch you are working on is ready, you request for it to
be merged with the master branch.</p>
<section id="before-opening-a-pull-request">
<h3>Before opening a pull request<a class="headerlink" href="#before-opening-a-pull-request" title="Permalink to this headline"></a></h3>
<p>Before you create a pull request (or at least before you assign reviewers):</p>
<ul class="simple">
<li><p>Rebase your branch on the latest master/main to make sure there have been no
conflicting changes in the meantime.</p></li>
<li><p>Remove any debug code or commented code that is not needed anymore.</p></li>
<li><p>Test all new features and also existing ones if they are affected by your
change.  Unit tests are great for this!</p></li>
<li><p>Document new features and update existing documentation if something changed.</p></li>
<li><p>Add new unit tests and demos where appropriate.</p></li>
<li><p>Run the auto-formatting tools on all new/modified files (see above).</p></li>
</ul>
</section>
<section id="creating-a-pull-request">
<h3>Creating a pull request<a class="headerlink" href="#creating-a-pull-request" title="Permalink to this headline"></a></h3>
<ul class="simple">
<li><p>Visit the repository on GitHub,</p></li>
<li><p>click on the link “Pull requests”,</p></li>
<li><p>create a new pull request, assign yourself and select reviewers using the web
interface,</p></li>
<li><p>select an appropriate label.</p></li>
</ul>
<p>It is good manner to squash commits that logically belong together (e.g. multiple small changes on the same part of code) before a code review (see below), as this makes the work of the reviewer easier and leads to a cleaner git history. See for example these <a class="reference external" href="http://gitready.com/advanced/2009/02/10/squashing-commits-with-rebase.html">instructions</a>.</p>
<p>In the pull request text:</p>
<ul class="simple">
<li><p>describe what functionality you added or updated, and why</p></li>
<li><p>describe how you know the code you wrote works (e.g. running unit tests and/or demos)</p></li>
<li><p>confirm you followed the guidelines and used the formatting tools</p></li>
</ul>
</section>
<section id="during-the-review">
<h3>During the review<a class="headerlink" href="#during-the-review" title="Permalink to this headline"></a></h3>
<ul class="simple">
<li><p>The reviewers will take a look at your changes and may have some comments
asking for clarifications or requesting changes.  Address all their comments.</p></li>
<li><p>To address change requests, you can simply push more commits to the
corresponding branch.  They will automatically show up in the pull request and
reviewers get a notification.</p></li>
<li><p>While the review is ongoing, avoid modifications of the git history (e.g.
amending or squashing of commits).  This way the reviewers can more easily see
what changes you made since their last review.</p></li>
<li><p>You may only merge the pull request once all reviewers have approved.</p></li>
</ul>
</section>
<section id="merging-a-pull-request">
<h3>Merging a pull request<a class="headerlink" href="#merging-a-pull-request" title="Permalink to this headline"></a></h3>
<p>Once all reviewers have approved, you can merge the pull request via the web
interface.</p>
<p>Before merging, you may clean up the git history (e.g. squash commits).</p>
<p>After merging, <strong>delete</strong> the corresponding branch.  <strong>Do not continue to use
the branch</strong> after it was merged as this will likely cause a lot of chaos and
confusion later on.</p>
</section>
<section id="some-general-rules-for-pull-requests">
<h3>Some general rules for pull requests:<a class="headerlink" href="#some-general-rules-for-pull-requests" title="Permalink to this headline"></a></h3>
<ul class="simple">
<li><p>To make life easier for the reviewers and to get your changes merged faster
(thus reducing the risk of merge conflicts), try to keep merge requests rather
small. This means that, where possible, a bigger task should be split into
smaller sub-tasks that can be merged one after another instead of putting
everything in one huge merge request.</p></li>
<li><p>Do not add functional changes and major reformatting in the same commit as
this makes review of the functional changes very difficult.</p></li>
</ul>
</section>
<section id="on-which-packages-is-code-review-required">
<h3>On which packages is code review required?<a class="headerlink" href="#on-which-packages-is-code-review-required" title="Permalink to this headline"></a></h3>
<p>Changes on core packages (e.g. <code class="docutils literal notranslate"><span class="pre">shared_memory</span></code>, <code class="docutils literal notranslate"><span class="pre">o80</span></code>, …) must be reviewed by
at least one maintainer before they are merged.</p>
<p>On project-specific repositories on which no one else depends, reviews are still
encouraged but not mandatory (e.g. it may not be useful to review every change
while experimentation is still ongoing).  However, the code should be reviewed
before it is executed on a real robot.</p>
</section>
</section>
<section id="being-a-reviewer">
<h2>Being a Reviewer<a class="headerlink" href="#being-a-reviewer" title="Permalink to this headline"></a></h2>
<p>Note that yourself will certainly also be requested to perform review. If so:</p>
<ul class="simple">
<li><p><strong>Try to provide reviews in a timely manner</strong>. The contributor may be blocked in
continuing their work while the pull request is under review.</p></li>
<li><p>When reviewing, check the following things:</p>
<ul>
<li><p>Is the code modular and properly commented?</p></li>
<li><p>Is the style guide followed?</p></li>
<li><p>Are new features/changes properly documented?</p></li>
<li><p>Are there unit tests/demos for new features?</p></li>
<li><p>And of course: Do the changes look reasonable and correct?</p></li>
</ul>
</li>
<li><p>Avoid requesting micro optimizations and non-consequential modifications of
the code.</p></li>
<li><p>Avoid requesting the development of new features (e.g. “this is useful, but
you can also add …”), as one could argue you could also add these extra
features yourself.</p></li>
<li><p><strong>Do not merge</strong>, just approve the pull request if everything is okay.  Actual
merging is done by one who contributed the pull request.  An exception is of
course, if the contributor does not have the permissions to merge themselves
on the corresponding repository.  In this case, check first, if the git
history of the branch should be squashed first.</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="E1_tools.html" class="btn btn-neutral float-left" title="Developer’s guide 1: Tools" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="E3_packages_overview.html" class="btn btn-neutral float-right" title="Developer’s guide 3: Packages overview" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Empirical Inference, Max Planck Institute for Intelligent Systems.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>